function f = self_tr(x,u,mu)

x1=x(1);
x2=x(2);
v=u(1);

A=[1.019,0.06178;0.6054,1.019];
B=[-0.0006296;-0.02057];
K=[ 45.0411   14.3995;
   37.1378   11.8730;
   30.3797    9.7133;
   25.0432    8.0079;
   20.5758    6.5801;
   17.1704    5.4916;
   13.9627    4.4661;
   12.5566    4.0161;
    9.4839    3.0339;
    5.9480    1.9037];

x1=[1,0]*(A*[x1;x2]+B*v);
x2=[0,1]*(A*[x1;x2]+B*v);
v=K(1,:)*x';


for j=2:10
 
a=x1^2+x2^2;    
du=K(j,:)*x'-K(1,:)*[x1;x2];
    
x1=[1,0]*(A*[x1;x2]+B*v);
x2=[0,1]*(A*[x1;x2]+B*v);

f=10;

     if du'*du > mu*(a+x1^2+x2^2)
         f = j-1;
         break;
     end
 
v=K(j,:)*x';
 
end
